# PipeWire configuration template for Redragon Wireless Headsets
# This forces PipeWire to use hardware volume control instead of software
#
# ⚠️  IMPORTANTE: Use o script configure-pipewire.sh para configuração automática!
#     Ele detecta o seu dispositivo e gera a configuração correta.
#
# Installation (manual - não recomendado):
# 1. Detecte o sink do seu headset:
#    pactl list sinks short | grep -E 'Redragon|XiiSound|Weltrend'
#
# 2. Substitua SINK_NAME_HERE abaixo pelo nome do sink
#
# 3. Copie para o diretório de configuração:
#    mkdir -p ~/.config/pipewire/pipewire.conf.d/
#    cp pipewire-redragon-template.conf ~/.config/pipewire/pipewire.conf.d/redragon-headset.conf
#
# 4. Edite o arquivo copiado e substitua SINK_NAME_HERE
#
# 5. Reinicie o PipeWire:
#    systemctl --user restart pipewire pipewire-pulse

# Force PipeWire to map volume directly to ALSA controls
# This prevents the binary behavior (100% = ALSA 100, <100% = ALSA 0)
context.rules = [
    {
        matches = [
            {
                node.name = "~alsa_output.usb-.*XiiSound.*"
            }
            {
                node.name = "~alsa_output.usb-.*Weltrend.*"
            }
            {
                node.name = "~alsa_output.usb-.*Redragon.*"
            }
        ]
        actions = {
            update-props = {
                # Force hardware volume control mapping
                api.alsa.soft-mixer = false
                api.alsa.headroom = 0
                channelmix.normalize = false
            }
        }
    }
]
